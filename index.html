<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“Š Ø§Ø³Ú©Ø±Ù¾Ø± Ù‚ÛŒÙ…Øª ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø§Ø² ØªØ±Ø¨</title>
    
    <!-- ÙÙˆÙ†Øª ÙˆØ²ÛŒØ± -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Ø±ÛŒØ³Øª Ø§Ø³ØªØ§ÛŒÙ„ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Vazirmatn', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        
        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            padding: 30px 20px;
            color: white;
            margin-bottom: 20px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        /* Card */
        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2d3436;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #6c5ce7;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: #2d3436;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #636e72;
            font-size: 0.8rem;
        }
        
        /* Table */
        .products-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .products-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: right;
            color: #636e72;
            font-weight: 600;
            border-bottom: 2px solid #e9ecef;
        }
        
        .products-table td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .products-table tr:hover {
            background: #f8f9fa;
        }
        
        .product-name {
            font-weight: 600;
            color: #2d3436;
        }
        
        .product-price {
            font-weight: 700;
            color: #00b894;
        }
        
        /* Buttons */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-family: 'Vazirmatn', sans-serif;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-primary {
            background: #6c5ce7;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5b4bd4;
        }
        
        /* Chart Container */
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1><i class="fas fa-chart-line"></i> Ø§Ø³Ú©Ø±Ù¾Ø± Ù‚ÛŒÙ…Øª Ø§Ø² ØªØ±Ø¨</h1>
        <p>Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…: Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‚ÛŒÙ…Øª Ûµ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ø§ÙˆÙ„</p>
    </div>
    
    <div class="container">
        <!-- Stats Cards -->
        <div class="stats-grid" id="statsContainer">
            <!-- Ø¢Ù…Ø§Ø± Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
        </div>
        
        <!-- Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ -->
        <div class="card" style="margin-bottom: 20px;">
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="loadSampleData()">
                    <i class="fas fa-database"></i> Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
                </button>
                <button class="btn btn-primary" onclick="scrapeFromTorob()" style="background: #00b894;">
                    <i class="fas fa-search"></i> Ø§Ø³Ú©Ø±Ù¾ Ø§Ø² ØªØ±Ø¨ (Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ)
                </button>
            </div>
        </div>
        
        <!-- ÙÛŒÙ„ØªØ±Ù‡Ø§ -->
        <div class="card" style="margin-bottom: 20px;">
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <select id="brandFilter" onchange="filterProducts()" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #ddd;">
                    <option value="">Ù‡Ù…Ù‡ Ø¨Ø±Ù†Ø¯Ù‡Ø§</option>
                </select>
                
                <select id="sizeFilter" onchange="filterProducts()" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #ddd;">
                    <option value="">Ù‡Ù…Ù‡ Ø³Ø§ÛŒØ²Ù‡Ø§</option>
                </select>
                
                <select id="sortFilter" onchange="filterProducts()" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #ddd;">
                    <option value="newest">Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ†</option>
                    <option value="price_asc">Ù‚ÛŒÙ…Øª (Ú©Ù… Ø¨Ù‡ Ø²ÛŒØ§Ø¯)</option>
                    <option value="price_desc">Ù‚ÛŒÙ…Øª (Ø²ÛŒØ§Ø¯ Ø¨Ù‡ Ú©Ù…)</option>
                </select>
            </div>
        </div>
        
        <!-- Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ -->
        <div class="dashboard-grid">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-chart-line"></i> Ø±Ø§Ø¨Ø·Ù‡ Ø³Ø§ÛŒØ² Ùˆ Ù‚ÛŒÙ…Øª</h2>
                </div>
                <div class="chart-container">
                    <canvas id="sizePriceChart"></canvas>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-chart-bar"></i> Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø±Ù†Ø¯Ù‡Ø§</h2>
                </div>
                <div class="chart-container">
                    <canvas id="brandChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Ø¬Ø¯ÙˆÙ„ Ù…Ø­ØµÙˆÙ„Ø§Øª -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-list"></i> Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª</h2>
                <span id="productsCount">0 Ù…Ø­ØµÙˆÙ„</span>
            </div>
            <div id="productsTable">
                <div style="text-align: center; padding: 40px; color: #636e72;">
                    <i class="fas fa-database" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª. Ø±ÙˆÛŒ "Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ==================== Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ ====================
        const sampleProducts = [
            {
                id: 1,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ QLED 55 Ø§ÛŒÙ†Ú†",
                brand: "Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯",
                size: 55,
                technology: "QLED",
                price: 35000000,
                discount: 12,
                rating: 4.5,
                seller_count: 7,
                price_min: 32000000,
                price_max: 38000000,
                source: "torob"
            },
            {
                id: 2,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø§Ù„ Ø¬ÛŒ OLED 65 Ø§ÛŒÙ†Ú†",
                brand: "Ø§Ù„ Ø¬ÛŒ",
                size: 65,
                technology: "OLED",
                price: 45000000,
                discount: 8,
                rating: 4.8,
                seller_count: 5,
                price_min: 43000000,
                price_max: 48000000,
                source: "torob"
            },
            {
                id: 3,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø³ÙˆÙ†ÛŒ 4K 43 Ø§ÛŒÙ†Ú†",
                brand: "Ø³ÙˆÙ†ÛŒ",
                size: 43,
                technology: "LED",
                price: 22000000,
                discount: 10,
                rating: 4.3,
                seller_count: 4,
                price_min: 20000000,
                price_max: 24000000,
                source: "torob"
            },
            {
                id: 4,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† TCL Mini LED 75 Ø§ÛŒÙ†Ú†",
                brand: "TCL",
                size: 75,
                technology: "Mini LED",
                price: 52000000,
                discount: 15,
                rating: 4.6,
                seller_count: 3,
                price_min: 50000000,
                price_max: 55000000,
                source: "torob"
            },
            {
                id: 5,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø´ÛŒØ§Ø¦ÙˆÙ…ÛŒ Smart 50 Ø§ÛŒÙ†Ú†",
                brand: "Ø´ÛŒØ§Ø¦ÙˆÙ…ÛŒ",
                size: 50,
                technology: "LED",
                price: 18000000,
                discount: 20,
                rating: 4.2,
                seller_count: 8,
                price_min: 16000000,
                price_max: 20000000,
                source: "torob"
            },
            {
                id: 6,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ù‡Ø§ÛŒØ³Ù†Ø³ UHD 55 Ø§ÛŒÙ†Ú†",
                brand: "Ù‡Ø§ÛŒØ³Ù†Ø³",
                size: 55,
                technology: "LED",
                price: 25000000,
                discount: 5,
                rating: 4.0,
                seller_count: 6,
                price_min: 24000000,
                price_max: 26000000,
                source: "torob"
            },
            {
                id: 7,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ù¾Ø§Ù†Ø§Ø³ÙˆÙ†ÛŒÚ© 43 Ø§ÛŒÙ†Ú†",
                brand: "Ù¾Ø§Ù†Ø§Ø³ÙˆÙ†ÛŒÚ©",
                size: 43,
                technology: "LED",
                price: 19000000,
                discount: 7,
                rating: 4.1,
                seller_count: 2,
                price_min: 18500000,
                price_max: 19500000,
                source: "torob"
            },
            {
                id: 8,
                name: "ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯ 4K 65 Ø§ÛŒÙ†Ú†",
                brand: "Ø³Ø§Ù…Ø³ÙˆÙ†Ú¯",
                size: 65,
                technology: "LED",
                price: 38000000,
                discount: 10,
                rating: 4.4,
                seller_count: 9,
                price_min: 35000000,
                price_max: 40000000,
                source: "torob"
            }
        ];
        
        let allProducts = [];
        let filteredProducts = [];
        let charts = {};
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ ====================
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
        function loadSampleData() {
            console.log("ğŸ“Š Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡...");
            
            allProducts = [...sampleProducts];
            filteredProducts = [...allProducts];
            
            // Ø¢Ù¾Ø¯ÛŒØª ÙÛŒÙ„ØªØ±Ù‡Ø§
            updateFilters();
            
            // Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª
            displayProducts();
            
            // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
            updateStats();
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
            createCharts();
            
            console.log("âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯");
            alert("âœ… Û¸ Ù…Ø­ØµÙˆÙ„ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯!");
        }
        
        // Ø§Ø³Ú©Ø±Ù¾ Ø§Ø² ØªØ±Ø¨ (Ø¢Ø²Ù…Ø§ÛŒØ´ÛŒ)
        function scrapeFromTorob() {
            alert("ğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.\n\nØ¨Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø² ØªØ±Ø¨ØŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ø³Ø±ÙˆØ± Node.js Ø¯Ø§Ø±ÛŒØ¯.");
            loadSampleData();
        }
        
        // Ø¢Ù¾Ø¯ÛŒØª ÙÛŒÙ„ØªØ±Ù‡Ø§
        function updateFilters() {
            const brandFilter = document.getElementById('brandFilter');
            const sizeFilter = document.getElementById('sizeFilter');
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
            while (brandFilter.options.length > 1) brandFilter.remove(1);
            while (sizeFilter.options.length > 1) sizeFilter.remove(1);
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨Ø±Ù†Ø¯Ù‡Ø§
            const brands = [...new Set(allProducts.map(p => p.brand).filter(Boolean))];
            brands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandFilter.appendChild(option);
            });
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø³Ø§ÛŒØ²Ù‡Ø§
            const sizes = [...new Set(allProducts.map(p => p.size).filter(Boolean))].sort((a, b) => a - b);
            sizes.forEach(size => {
                const option = document.createElement('option');
                option.value = size;
                option.textContent = `${size} Ø§ÛŒÙ†Ú†`;
                sizeFilter.appendChild(option);
            });
        }
        
        // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ù…Ø­ØµÙˆÙ„Ø§Øª
        function filterProducts() {
            const brand = document.getElementById('brandFilter').value;
            const size = document.getElementById('sizeFilter').value;
            const sort = document.getElementById('sortFilter').value;
            
            filteredProducts = allProducts.filter(product => {
                if (brand && product.brand !== brand) return false;
                if (size && product.size !== parseInt(size)) return false;
                return true;
            });
            
            // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ
            switch(sort) {
                case 'price_asc':
                    filteredProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price_desc':
                    filteredProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'newest':
                default:
                    break;
            }
            
            displayProducts();
            updateStats();
            updateCharts();
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª
        function displayProducts() {
            const container = document.getElementById('productsTable');
            const countElement = document.getElementById('productsCount');
            
            countElement.textContent = `${filteredProducts.length} Ù…Ø­ØµÙˆÙ„`;
            
            if (filteredProducts.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #636e72;">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px;"></i>
                        <p>Ù…Ø­ØµÙˆÙ„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>
                    </div>
                `;
                return;
            }
            
            let tableHTML = `
                <div style="overflow-x: auto;">
                    <table class="products-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„</th>
                                <th>Ø¨Ø±Ù†Ø¯</th>
                                <th>Ø³Ø§ÛŒØ²</th>
                                <th>Ù‚ÛŒÙ…Øª Ù…Ø±Ø¬Ø¹</th>
                                <th>ØªØ®ÙÛŒÙ</th>
                                <th>ÙØ±ÙˆØ´Ù†Ø¯Ú¯Ø§Ù†</th>
                                <th>Ø±Ù†Ø¬ Ù‚ÛŒÙ…Øª</th>
                                <th>Ø±ØªØ¨Ù‡</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            filteredProducts.forEach((product, index) => {
                const priceRange = product.price_min && product.price_max
                    ? `${product.price_min.toLocaleString('fa-IR')} - ${product.price_max.toLocaleString('fa-IR')}`
                    : `${product.price.toLocaleString('fa-IR')}`;
                
                const sellerBadge = product.seller_count > 3
                    ? `<span style="background: #00b894; color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem;">${product.seller_count} ÙØ±ÙˆØ´Ù†Ø¯Ù‡</span>`
                    : `<span style="background: #636e72; color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem;">${product.seller_count} ÙØ±ÙˆØ´Ù†Ø¯Ù‡</span>`;
                
                const discountBadge = product.discount > 0
                    ? `<span style="background: #e17055; color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem;">${product.discount}%</span>`
                    : '';
                
                const ratingStars = 'â˜…'.repeat(Math.floor(product.rating)) + 'â˜†'.repeat(5 - Math.floor(product.rating));
                
                tableHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td class="product-name">${product.name}</td>
                        <td>${product.brand}</td>
                        <td>${product.size} Ø§ÛŒÙ†Ú†</td>
                        <td class="product-price">${product.price.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù†</td>
                        <td>${discountBadge}</td>
                        <td>${sellerBadge}</td>
                        <td style="font-size: 0.9rem; color: #636e72;">${priceRange}</td>
                        <td style="color: #fdcb6e;">${ratingStars}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                        </tbody>
                    </table>
                </div>
                <div style="text-align: center; margin-top: 15px; color: #636e72; font-size: 0.8rem;">
                    <p><i class="fas fa-info-circle"></i> Ù‚ÛŒÙ…Øª Ù…Ø±Ø¬Ø¹: Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‚ÛŒÙ…Øª Ûµ ÙØ±ÙˆØ´Ù†Ø¯Ù‡ Ø§ÙˆÙ„ Ø¯Ø± ØªØ±Ø¨</p>
                </div>
            `;
            
            container.innerHTML = tableHTML;
        }
        
        // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
        function updateStats() {
            const products = filteredProducts.length > 0 ? filteredProducts : allProducts;
            
            if (products.length === 0) {
                document.getElementById('statsContainer').innerHTML = `
                    <div class="stat-card">
                        <i class="fas fa-exclamation-triangle stat-icon"></i>
                        <div class="stat-number">0</div>
                        <div class="stat-label">Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</div>
                    </div>
                `;
                return;
            }
            
            const prices = products.map(p => p.price);
            const avgPrice = Math.round(prices.reduce((a, b) => a + b, 0) / prices.length);
            const totalSellers = products.reduce((sum, p) => sum + p.seller_count, 0);
            const avgSellers = Math.round(totalSellers / products.length);
            const maxSellers = Math.max(...products.map(p => p.seller_count));
            
            const statsHTML = `
                <div class="stat-card">
                    <i class="fas fa-tv stat-icon"></i>
                    <div class="stat-number">${products.length}</div>
                    <div class="stat-label">ØªØ¹Ø¯Ø§Ø¯ Ù…Ø­ØµÙˆÙ„Ø§Øª</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-money-bill-wave stat-icon"></i>
                    <div class="stat-number">${avgPrice.toLocaleString('fa-IR')}</div>
                    <div class="stat-label">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‚ÛŒÙ…Øª</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-store stat-icon"></i>
                    <div class="stat-number">${avgSellers}</div>
                    <div class="stat-label">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† ÙØ±ÙˆØ´Ù†Ø¯Ù‡</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-chart-bar stat-icon"></i>
                    <div class="stat-number">${maxSellers}</div>
                    <div class="stat-label">Ø¨ÛŒØ´ØªØ±ÛŒÙ† ÙØ±ÙˆØ´Ù†Ø¯Ù‡</div>
                </div>
            `;
            
            document.getElementById('statsContainer').innerHTML = statsHTML;
        }
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
        function createCharts() {
            // Ù†Ù…ÙˆØ¯Ø§Ø± Ø±Ø§Ø¨Ø·Ù‡ Ø³Ø§ÛŒØ² Ùˆ Ù‚ÛŒÙ…Øª
            const sizePriceCtx = document.getElementById('sizePriceChart').getContext('2d');
            
            if (charts.sizePriceChart) {
                charts.sizePriceChart.destroy();
            }
            
            charts.sizePriceChart = new Chart(sizePriceCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Ø±Ø§Ø¨Ø·Ù‡ Ø³Ø§ÛŒØ² Ùˆ Ù‚ÛŒÙ…Øª',
                        data: filteredProducts.map(p => ({
                            x: p.size,
                            y: p.price,
                            name: p.name,
                            brand: p.brand,
                            price: p.price,
                            sellers: p.seller_count
                        })),
                        backgroundColor: '#6c5ce7',
                        pointRadius: 6,
                        pointHoverRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            rtl: true
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const point = context.raw;
                                    return [
                                        `Ù†Ø§Ù…: ${point.name}`,
                                        `Ø¨Ø±Ù†Ø¯: ${point.brand}`,
                                        `Ø³Ø§ÛŒØ²: ${point.x} Ø§ÛŒÙ†Ú†`,
                                        `Ù‚ÛŒÙ…Øª: ${point.y.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù†`,
                                        `ÙØ±ÙˆØ´Ù†Ø¯Ú¯Ø§Ù†: ${point.sellers}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Ø³Ø§ÛŒØ² (Ø§ÛŒÙ†Ú†)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString('fa-IR');
                                }
                            }
                        }
                    }
                }
            });
            
            // Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø±Ù†Ø¯Ù‡Ø§
            const brandCtx = document.getElementById('brandChart').getContext('2d');
            
            if (charts.brandChart) {
                charts.brandChart.destroy();
            }
            
            const brands = [...new Set(filteredProducts.map(p => p.brand))];
            const brandAverages = brands.map(brand => {
                const brandProducts = filteredProducts.filter(p => p.brand === brand);
                return Math.round(brandProducts.reduce((sum, p) => sum + p.price, 0) / brandProducts.length);
            });
            
            charts.brandChart = new Chart(brandCtx, {
                type: 'bar',
                data: {
                    labels: brands,
                    datasets: [{
                        label: 'Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‚ÛŒÙ…Øª Ø¨Ø±Ù†Ø¯Ù‡Ø§',
                        data: brandAverages,
                        backgroundColor: '#00b894'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            rtl: true
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString('fa-IR');
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Ø¢Ù¾Ø¯ÛŒØª Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
        function updateCharts() {
            createCharts();
        }
        
        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            console.log("âœ… ØµÙØ­Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯");
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ø² 1 Ø«Ø§Ù†ÛŒÙ‡
            setTimeout(() => {
                loadSampleData();
            }, 1000);
        });
    </script>
</body>
</html>
